# Atlassian BitBucket CVE-2022-36804

## Description of Vulnerability

A vulnerability(CVE-2022-36804) in Bitbucket allows a remote code execution.
An attacker with access with read or public access to a
repository can execute arbitrary code by sending a malicious
HTTP request. All versions released after 6.10.17
including 7.0.0 and newer are affected, this means that all
instances that are running any versions between 7.0.0 and
8.3.0 inclusive can be exploited by this vulnerability.

## Vulnerable setup


1. download image and run the container

use the official docker image
```sh
docker pull atlassian/bitbucket:8.3.0

docker run  --name="tsunami-bitbucket-8-3" -d -p 37990:7990 -p 37999:7999 atlassian/bitbucket:8.3.0
```
2. install bitbucket and fill license code

Installing bitbucket requires a license code. After using docker to start the bitbucket environment, you need to access port 37990 and fill in your test license code.Log in to the URL "my.atlassian.com" to generate a trial license code. 

3. setup administrator account and create a public repo

create administrator and login admin:123456

create a project, name public or whatever

create a repository or import repositories, just as a example import from git and fill the Clone URL : https://github.com/google/tsunami-security-scanner-plugins

In Repository settings -> Repository permissions -> public access , enable allow users without Bitbucket account to clone and browse this repository


## Non-vulnerable setup

Only the version of the bitbucket container needs to be changed:

```sh
docker pull atlassian/bitbucket:8.3.1

docker run  --name="tsunami-bitbucket-8-3" -d -p 37990:7990 -p 37999:7999 atlassian/bitbucket:8.3.1
```
